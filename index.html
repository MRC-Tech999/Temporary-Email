<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Temporary Email - Marc-Tech</title>
  <style>
    /* Ajoute tes styles ici... */
  </style>
</head>
<body>
  <h1>Temporary Email</h1>
  
  <!-- Email box with copy button -->
  <div class="email-box">
    Votre email temporaire : <span class="email" id="emailDisplay"></span>
    <button onclick="copyEmail()">Copier l'email</button>
    <button onclick="g()">Actualiser</button> <!-- Lien avec la fonction g -->
  </div>

  <!-- Messages section (inbox) -->
  <div id="messages"></div>

  <div class="footer">
    Tous droits réservés © 2025 - Marc-Tech
  </div>

  <!-- Script sécurisé et obfusqué -->
  <script>
    (function(){
      const $ = [
        "random", "substring", "@mailsac.com", "getElementById", "textContent", "messages", "length", "innerHTML", "<p>Aucun message pour l'instant.</p>", "forEach", "createElement", "className", "message",
        "<p><strong>De :</strong> ", "from", "</p><p><strong>Sujet :</strong> ", "subject", "</p><button onclick=\"r('", "_id", "')\">Lire</button><div id=\"body-", "body-", "appendChild",
        "headers", "Mailsac-Key", "k_SlFHIkRTITLDKtpxYoQ8JX0ua9pnKIyBgQ0537", "then", "json", "fetch", "/api/addresses/", "/messages", "g", "text", "pre"
      ];
      let e = () => Math[$[0]]().toString(36)[$[1]](2, 10) + $[2];
      let m = e();
      document[$[3]]("emailDisplay")[$[4]] = m;

      window.g = function() {
        fetch("https://mailsac.com" + $[29] + m + $[30], {
          [$[21]]: { [$[22]]: $[23] }
        })[$[24]]($[25])[$[24]](msgs => {
          let c = document[$[3]]("messages");
          c[$[7]] = "";  // Clear the current messages
          if (!msgs[$[6]]) {
            c[$[7]] = $[8];  // Display "No messages yet" message
            return;
          }
          msgs[$[9]](msg => {
            let d = document[$[10]]("div");
            d[$[11]] = $[12];
            d[$[7]] = `<div class="message-box">
                          <h4>De : ${msg[$[14]]}</h4>
                          <p>Sujet : ${msg[$[16]]}</p>
                          <button onclick="r('${msg[$[18]]}')">Lire</button>
                        </div>`;
            c[$[20]](d);
          });
        });
      };

      window.r = function(i) {
        fetch(`https://mailsac.com/api/text/${m}/${i}`, {
          [$[21]]: { [$[22]]: $[23] }
        })[$[24]]($[31])[$[24]](txt => {
          document[$[3]]($[19]+i)[$[7]] = `<pre>${txt}</pre>`;
        });
      };

      // Fonction pour copier l'email
      window.copyEmail = function() {
        const emailText = document.getElementById("emailDisplay").textContent;
        navigator.clipboard.writeText(emailText)
          .then(() => {
            alert("Email copié dans le presse-papier !");
          })
          .catch(err => {
            alert("Échec de la copie: " + err);
          });
      };
    })();
  </script>
</body>
</html>
